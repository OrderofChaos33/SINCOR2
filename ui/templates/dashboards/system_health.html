{% extends "base.html" %}

{% block title %}System Health Dashboard - SINCOR{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-50">
    <!-- Header -->
    <div class="bg-white shadow">
        <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center">
                <h1 class="text-3xl font-bold text-gray-900">System Health Dashboard</h1>
                <div class="flex items-center space-x-4">
                    <div class="flex items-center">
                        <div class="w-3 h-3 bg-green-500 rounded-full mr-2"></div>
                        <span class="text-sm font-medium text-gray-700">All Systems Operational</span>
                    </div>
                    <button id="run-diagnostics-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">
                        Run Full Diagnostics
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
        <!-- Status Overview -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="bg-white overflow-hidden shadow rounded-lg">
                <div class="p-5">
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                            <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                        </div>
                        <div class="ml-4">
                            <h3 class="text-lg font-medium text-gray-900">API Status</h3>
                            <p class="text-sm text-green-600">Operational</p>
                            <p class="text-xs text-gray-500">99.9% uptime</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-white overflow-hidden shadow rounded-lg">
                <div class="p-5">
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                            <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                        </div>
                        <div class="ml-4">
                            <h3 class="text-lg font-medium text-gray-900">Database</h3>
                            <p class="text-sm text-green-600">Healthy</p>
                            <p class="text-xs text-gray-500">12ms avg response</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-white overflow-hidden shadow rounded-lg">
                <div class="p-5">
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center">
                            <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
                        </div>
                        <div class="ml-4">
                            <h3 class="text-lg font-medium text-gray-900">Storage</h3>
                            <p class="text-sm text-yellow-600">Warning</p>
                            <p class="text-xs text-gray-500">78% capacity</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-white overflow-hidden shadow rounded-lg">
                <div class="p-5">
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                            <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                        </div>
                        <div class="ml-4">
                            <h3 class="text-lg font-medium text-gray-900">Security</h3>
                            <p class="text-sm text-green-600">Secure</p>
                            <p class="text-xs text-gray-500">No threats detected</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- System Performance -->
            <div class="bg-white shadow rounded-lg">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h3 class="text-lg font-medium text-gray-900">System Performance</h3>
                </div>
                <div class="p-6">
                    <!-- CPU Usage -->
                    <div class="mb-6">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-medium text-gray-700">CPU Usage</span>
                            <span class="text-sm text-gray-500">32%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-green-500 h-2 rounded-full" style="width: 32%"></div>
                        </div>
                    </div>

                    <!-- Memory Usage -->
                    <div class="mb-6">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-medium text-gray-700">Memory Usage</span>
                            <span class="text-sm text-gray-500">67%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-yellow-500 h-2 rounded-full" style="width: 67%"></div>
                        </div>
                    </div>

                    <!-- Disk Usage -->
                    <div class="mb-6">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-medium text-gray-700">Disk Usage</span>
                            <span class="text-sm text-gray-500">78%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-yellow-500 h-2 rounded-full" style="width: 78%"></div>
                        </div>
                    </div>

                    <!-- Network Throughput -->
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-medium text-gray-700">Network Throughput</span>
                            <span class="text-sm text-gray-500">45 Mbps</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-green-500 h-2 rounded-full" style="width: 45%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Service Status -->
            <div class="bg-white shadow rounded-lg">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h3 class="text-lg font-medium text-gray-900">Service Status</h3>
                </div>
                <div class="p-6">
                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                <span class="text-sm font-medium">Web Application</span>
                            </div>
                            <span class="text-xs text-green-600">Running</span>
                        </div>

                        <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                <span class="text-sm font-medium">Authentication Service</span>
                            </div>
                            <span class="text-xs text-green-600">Running</span>
                        </div>

                        <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                <span class="text-sm font-medium">Analytics Engine</span>
                            </div>
                            <span class="text-xs text-green-600">Running</span>
                        </div>

                        <div class="flex items-center justify-between p-3 bg-yellow-50 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-2 h-2 bg-yellow-500 rounded-full mr-3"></div>
                                <span class="text-sm font-medium">Backup Service</span>
                            </div>
                            <span class="text-xs text-yellow-600">Maintenance</span>
                        </div>

                        <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                <span class="text-sm font-medium">Email Service</span>
                            </div>
                            <span class="text-xs text-green-600">Running</span>
                        </div>

                        <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                <span class="text-sm font-medium">Report Generator</span>
                            </div>
                            <span class="text-xs text-green-600">Running</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Error Logs -->
            <div class="bg-white shadow rounded-lg">
                <div class="px-6 py-4 border-b border-gray-200">
                    <div class="flex justify-between items-center">
                        <h3 class="text-lg font-medium text-gray-900">Recent Error Logs</h3>
                        <button class="text-blue-600 hover:text-blue-700 text-sm font-medium">View All</button>
                    </div>
                </div>
                <div class="p-6">
                    <div class="space-y-4">
                        <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4">
                            <div class="flex">
                                <div class="flex-shrink-0">
                                    <svg class="h-5 w-5 text-yellow-400" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                                    </svg>
                                </div>
                                <div class="ml-3">
                                    <p class="text-sm text-yellow-800">
                                        <strong>Warning:</strong> High memory usage detected
                                    </p>
                                    <p class="text-xs text-yellow-600 mt-1">2 minutes ago</p>
                                </div>
                            </div>
                        </div>

                        <div class="border-l-4 border-blue-400 bg-blue-50 p-4">
                            <div class="flex">
                                <div class="flex-shrink-0">
                                    <svg class="h-5 w-5 text-blue-400" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                                    </svg>
                                </div>
                                <div class="ml-3">
                                    <p class="text-sm text-blue-800">
                                        <strong>Info:</strong> Scheduled backup completed successfully
                                    </p>
                                    <p class="text-xs text-blue-600 mt-1">15 minutes ago</p>
                                </div>
                            </div>
                        </div>

                        <div class="border-l-4 border-green-400 bg-green-50 p-4">
                            <div class="flex">
                                <div class="flex-shrink-0">
                                    <svg class="h-5 w-5 text-green-400" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                                    </svg>
                                </div>
                                <div class="ml-3">
                                    <p class="text-sm text-green-800">
                                        <strong>Success:</strong> System security scan completed
                                    </p>
                                    <p class="text-xs text-green-600 mt-1">1 hour ago</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- System Metrics -->
            <div class="bg-white shadow rounded-lg">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h3 class="text-lg font-medium text-gray-900">System Metrics</h3>
                </div>
                <div class="p-6">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="text-center p-4 bg-gray-50 rounded-lg">
                            <div class="text-2xl font-bold text-blue-600">99.9%</div>
                            <div class="text-sm text-gray-600">Uptime</div>
                        </div>
                        <div class="text-center p-4 bg-gray-50 rounded-lg">
                            <div class="text-2xl font-bold text-green-600">1,247</div>
                            <div class="text-sm text-gray-600">Active Users</div>
                        </div>
                        <div class="text-center p-4 bg-gray-50 rounded-lg">
                            <div class="text-2xl font-bold text-purple-600">45ms</div>
                            <div class="text-sm text-gray-600">Avg Response</div>
                        </div>
                        <div class="text-center p-4 bg-gray-50 rounded-lg">
                            <div class="text-2xl font-bold text-indigo-600">2.4GB</div>
                            <div class="text-sm text-gray-600">Data Processed</div>
                        </div>
                    </div>

                    <div class="mt-6">
                        <h4 class="text-sm font-medium text-gray-900 mb-3">Last System Check</h4>
                        <div class="space-y-2">
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600">Security Scan</span>
                                <span class="text-green-600">✓ Passed</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600">Performance Test</span>
                                <span class="text-green-600">✓ Passed</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600">Data Integrity</span>
                                <span class="text-green-600">✓ Verified</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600">Backup Status</span>
                                <span class="text-yellow-600">⚠ In Progress</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Center -->
        <div class="mt-8 bg-white shadow rounded-lg">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-900">Quick Actions</h3>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <button id="restart-services-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium">
                        Restart Services
                    </button>
                    <button id="quick-diagnostics-btn" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium">
                        Run Diagnostics
                    </button>
                    <button id="clear-cache-btn" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm font-medium">
                        Clear Cache
                    </button>
                    <button id="export-logs-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-medium">
                        Export Logs
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    
    // Load real system data on page load
    loadRealSystemData();
    
    // Refresh real data every 30 seconds
    setInterval(loadRealSystemData, 30000);
    // Run Full Diagnostics
    document.getElementById('run-diagnostics-btn').addEventListener('click', function() {
        const btn = this;
        const originalText = btn.textContent;
        btn.textContent = 'Running Diagnostics...';
        btn.disabled = true;
        
        setTimeout(() => {
            alert('✅ Full system diagnostics completed successfully!\n\n• CPU: Optimal\n• Memory: Good\n• Network: Excellent\n• Security: Secure');
            btn.textContent = originalText;
            btn.disabled = false;
        }, 3000);
    });
    
    // Restart Services
    document.getElementById('restart-services-btn').addEventListener('click', function() {
        const btn = this;
        const originalText = btn.textContent;
        btn.textContent = 'Restarting...';
        btn.disabled = true;
        
        setTimeout(() => {
            alert('✅ All services restarted successfully!\n\n• Web Application: Restarted\n• Database: Restarted\n• Analytics: Restarted');
            btn.textContent = originalText;
            btn.disabled = false;
        }, 2000);
    });
    
    // Quick Diagnostics
    document.getElementById('quick-diagnostics-btn').addEventListener('click', function() {
        const btn = this;
        const originalText = btn.textContent;
        btn.textContent = 'Checking...';
        btn.disabled = true;
        
        setTimeout(() => {
            alert('✅ Quick diagnostics completed!\n\n• System Health: Good\n• Performance: Optimal\n• Security: No threats');
            btn.textContent = originalText;
            btn.disabled = false;
        }, 1500);
    });
    
    // Clear Cache
    document.getElementById('clear-cache-btn').addEventListener('click', function() {
        const btn = this;
        const originalText = btn.textContent;
        btn.textContent = 'Clearing...';
        btn.disabled = true;
        
        setTimeout(() => {
            alert('✅ System cache cleared successfully!\n\n• Application Cache: Cleared\n• Database Cache: Cleared\n• Performance: Improved');
            btn.textContent = originalText;
            btn.disabled = false;
        }, 1000);
    });
    
    // Export Logs
    document.getElementById('export-logs-btn').addEventListener('click', function() {
        const logData = {
            timestamp: new Date().toISOString(),
            systemHealth: {
                cpu: '32%',
                memory: '67%',
                disk: '78%',
                network: '45 Mbps'
            },
            services: [
                { name: 'Web Application', status: 'Running' },
                { name: 'Database', status: 'Healthy' },
                { name: 'Analytics', status: 'Running' }
            ],
            logs: [
                { time: '2 min ago', message: 'High memory usage detected' },
                { time: '15 min ago', message: 'Backup completed successfully' },
                { time: '1 hour ago', message: 'Security scan completed' }
            ]
        };
        
        const blob = new Blob([JSON.stringify(logData, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'system-health-logs.json';
        a.click();
        URL.revokeObjectURL(url);
        
        alert('✅ System logs exported successfully!');
    });
    
    // Function to load real system data
    async function loadRealSystemData() {
        try {
            // Fetch real system health data
            const healthResponse = await fetch('/api/system/health');
            const healthData = await healthResponse.json();
            
            if (!healthData.error) {
                updateSystemMetrics(healthData);
            }
            
            // Fetch real service status
            const serviceResponse = await fetch('/api/services/status');
            const serviceData = await serviceResponse.json();
            
            if (!serviceData.error) {
                updateServiceStatus(serviceData.services);
            }
            
            // Fetch recent logs
            const logsResponse = await fetch('/api/logs/recent');
            const logsData = await logsResponse.json();
            
            if (!logsData.error) {
                updateRecentLogs(logsData.logs);
            }
            
        } catch (error) {
            console.error('Failed to load real system data:', error);
        }
    }
    
    function updateSystemMetrics(data) {
        // Update CPU usage
        const cpuBar = document.querySelector('.bg-green-500[style*="width: 32%"]') || 
                      document.querySelector('.bg-yellow-500[style*="width: 32%"]') ||
                      document.querySelector('.bg-red-500[style*="width: 32%"]');
        const cpuText = cpuBar?.parentElement?.previousElementSibling?.querySelector('.text-gray-500');
        
        if (cpuBar && cpuText) {
            cpuBar.style.width = data.cpu + '%';
            cpuBar.className = data.cpu > 80 ? 'bg-red-500 h-2 rounded-full' : 
                              data.cpu > 60 ? 'bg-yellow-500 h-2 rounded-full' : 
                              'bg-green-500 h-2 rounded-full';
            cpuText.textContent = data.cpu + '%';
        }
        
        // Update Memory usage
        const memoryBars = document.querySelectorAll('.h-2.rounded-full');
        const memoryBar = memoryBars[1]; // Second progress bar
        const memoryText = memoryBar?.parentElement?.previousElementSibling?.querySelector('.text-gray-500');
        
        if (memoryBar && memoryText) {
            memoryBar.style.width = data.memory + '%';
            memoryBar.className = data.memory > 85 ? 'bg-red-500 h-2 rounded-full' : 
                                 data.memory > 70 ? 'bg-yellow-500 h-2 rounded-full' : 
                                 'bg-green-500 h-2 rounded-full';
            memoryText.textContent = data.memory + '%';
        }
        
        // Update Disk usage
        const diskBar = memoryBars[2]; // Third progress bar
        const diskText = diskBar?.parentElement?.previousElementSibling?.querySelector('.text-gray-500');
        
        if (diskBar && diskText) {
            diskBar.style.width = data.disk + '%';
            diskBar.className = data.disk > 90 ? 'bg-red-500 h-2 rounded-full' : 
                               data.disk > 75 ? 'bg-yellow-500 h-2 rounded-full' : 
                               'bg-green-500 h-2 rounded-full';
            diskText.textContent = data.disk + '%';
        }
        
        // Update system metrics in the bottom section
        const metricsCards = document.querySelectorAll('.text-center.p-4.bg-gray-50.rounded-lg');
        
        // Update memory usage in metrics
        if (metricsCards.length > 2) {
            const memoryUsageCard = metricsCards[2];
            const memoryValue = memoryUsageCard.querySelector('.text-2xl.font-bold');
            if (memoryValue) {
                memoryValue.textContent = data.memory_used.toFixed(1) + 'GB';
            }
        }
    }
    
    function updateServiceStatus(services) {
        const serviceItems = document.querySelectorAll('.flex.items-center.justify-between.p-3');
        
        services.forEach((service, index) => {
            if (serviceItems[index]) {
                const statusSpan = serviceItems[index].querySelector('.text-xs');
                const indicator = serviceItems[index].querySelector('.w-2.h-2');
                const container = serviceItems[index];
                
                if (statusSpan && indicator) {
                    if (service.status === 'running') {
                        statusSpan.textContent = 'Running';
                        statusSpan.className = 'text-xs text-green-600';
                        indicator.className = 'w-2 h-2 bg-green-500 rounded-full mr-3';
                        container.className = 'flex items-center justify-between p-3 bg-green-50 rounded-lg';
                    } else {
                        statusSpan.textContent = 'Stopped';
                        statusSpan.className = 'text-xs text-red-600';
                        indicator.className = 'w-2 h-2 bg-red-500 rounded-full mr-3';
                        container.className = 'flex items-center justify-between p-3 bg-red-50 rounded-lg';
                    }
                }
            }
        });
    }
    
    function updateRecentLogs(logs) {
        const logContainer = document.querySelector('.space-y-4');
        if (!logContainer) return;
        
        // Clear existing logs
        logContainer.innerHTML = '';
        
        logs.slice(0, 3).forEach(log => {
            const logElement = document.createElement('div');
            
            let borderColor, bgColor, iconColor, textColor, icon;
            
            switch(log.level.toLowerCase()) {
                case 'warning':
                    borderColor = 'border-yellow-400';
                    bgColor = 'bg-yellow-50';
                    iconColor = 'text-yellow-400';
                    textColor = 'text-yellow-800';
                    icon = `<path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>`;
                    break;
                case 'error':
                    borderColor = 'border-red-400';
                    bgColor = 'bg-red-50';
                    iconColor = 'text-red-400';
                    textColor = 'text-red-800';
                    icon = `<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>`;
                    break;
                case 'success':
                    borderColor = 'border-green-400';
                    bgColor = 'bg-green-50';
                    iconColor = 'text-green-400';
                    textColor = 'text-green-800';
                    icon = `<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>`;
                    break;
                default: // info
                    borderColor = 'border-blue-400';
                    bgColor = 'bg-blue-50';
                    iconColor = 'text-blue-400';
                    textColor = 'text-blue-800';
                    icon = `<path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>`;
            }
            
            logElement.className = `border-l-4 ${borderColor} ${bgColor} p-4`;
            logElement.innerHTML = `
                <div class="flex">
                    <div class="flex-shrink-0">
                        <svg class="h-5 w-5 ${iconColor}" viewBox="0 0 20 20" fill="currentColor">
                            ${icon}
                        </svg>
                    </div>
                    <div class="ml-3">
                        <p class="text-sm ${textColor}">
                            <strong>${log.level}:</strong> ${log.message}
                        </p>
                        <p class="text-xs ${iconColor} mt-1">${log.minutes_ago} minute${log.minutes_ago !== 1 ? 's' : ''} ago</p>
                    </div>
                </div>
            `;
            
            logContainer.appendChild(logElement);
        });
    }
});
</script>
{% endblock %}